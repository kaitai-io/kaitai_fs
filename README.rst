========
KaitaiFS
========

KaitaiFS is a tool that allows you to mount any filesystem image,
container, archive file, etc, in a format specified using a `Kaitai
Struct <http://kaitai.io>`_ .ksy file.

Internally, it provides a thin binding of a Python parser generated by
Kaitai Struct compiler from a .ksy file to a FUSE (filesystem in
userspace) Python API.

Prerequisites
-------------

**Linux**

* `libfuse <https://github.com/libfuse/libfuse>`_

**Mac OS X**

* `osxfuse <https://github.com/osxfuse/osxfuse>`_

**Windows**

* `winfsp <https://github.com/billziss-gh/winfsp>`_
* If ``fusepy`` on `PyPI <https://pypi.org/project/fusepy/>`_ is still on 2.0.4:

   * Grab the latest ``fuse.py`` from `the fusepy repo
     <https://github.com/fusepy/fusepy/blob/master/fuse.py>`_
   * Put it into the ``kaitafs`` folder after cloning the repository
   * Change ``cli.py`` to import fuse.py relative to this directory by adding a
     dot infront of the package name, like so ``from .fuse import FUSE``

.. note:: ``fusepy`` was recently moved into a GitHub organization, see `this
   fusepy commit <https://github.com/fusepy/fusepy/commit/
   2da9212d253e566b7a41a80a692eb70204e953e5>`_.
   Because of this the PyPI package can currently not be updated, see
   `this fusepy issue <https://github.com/fusepy/fusepy/issues/118>`_.
   Until this is resolved ``fuse.py`` must be added manually on Windows.

Installation
------------

* Clone this repository
* Run ``python setup.py develop`` or ``python setup.py install`` (`difference
  explained on SO <https://stackoverflow.com/questions/19048732/python-setup-
  py-develop-vs-install>`_)

How to extend
-------------

Adapting any .ksy file to work with KaitaiFS should be pretty
easy. Generally, one needs to create a new binding file in ``fs``
package. For inspirations, see ``quake_pak_fs`` for a filesystem with
a flat list of file entries (note that file paths inside the
filesystem may be still hierarchical, it's just a list of file entries
that is flat!) and ``iso9660_fs`` for an example of a real-life
tree-based filesystem used on almost every data CD-ROM.

Licensing
---------

KaitaiFS is copyright (C) 2017 Kaitai Project.

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or (at
your option) any later version.

This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see `<https://www.gnu.org/licenses/>`_.

KaitaiFS uses parsers generated with Kaitai Struct, which are licensed as
specified in source .ksy files.
